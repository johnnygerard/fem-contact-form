@if (isSuccess()) {
  <app-toast />
}
<form
  class="p-300 md:p-500 w-form-mobile flex flex-col rounded-lg bg-white text-sm md:w-[690px] xl:w-[736px]"
  [formGroup]="fg"
  (ngSubmit)="onSubmit()"
>
  <h1 class="text-heading">Contact Us</h1>

  <div class="gap-300 md:gap-200 mt-400 flex flex-col md:flex-row">
    <!-- firstName -->
    <div class="gap-100 flex flex-col md:flex-1">
      <label class="c-star" for="f-first-name">First Name</label>
      <input
        class="c-text-field"
        [class.!border-red]="hasVisibleErrors(fg.controls.firstName)"
        type="text"
        id="f-first-name"
        formControlName="firstName"
        autocomplete="given-name"
      />
      @if (hasVisibleErrors(fg.controls.firstName, "required")) {
        <app-validation-message />
      }
    </div>

    <!-- lastName -->
    <div class="gap-100 flex flex-col md:flex-1">
      <label class="c-star" for="f-last-name">Last Name</label>
      <input
        class="c-text-field"
        [class.!border-red]="hasVisibleErrors(fg.controls.lastName)"
        type="text"
        id="f-last-name"
        formControlName="lastName"
        autocomplete="family-name"
      />
      @if (hasVisibleErrors(fg.controls.lastName, "required")) {
        <app-validation-message />
      }
    </div>
  </div>

  <!-- email -->
  <div class="gap-100 mt-300 flex flex-col">
    <label class="c-star" for="f-email">Email Address</label>
    <input
      class="c-text-field"
      [class.!border-red]="hasVisibleErrors(fg.controls.email)"
      type="email"
      id="f-email"
      formControlName="email"
      autocomplete="email"
    />
    @if (hasVisibleErrors(fg.controls.email, "required")) {
      <app-validation-message />
    }
    @if (hasVisibleErrors(fg.controls.email, "email")) {
      <app-validation-message content="Please enter a valid email address" />
    }
  </div>

  <!-- query -->
  <div class="my-300 gap-200 flex flex-col">
    <div class="c-star">Query Type</div>

    <div class="gap-200 flex flex-col md:flex-row">
      @for (
        queryType of ["General Enquiry", "Support Request"];
        track i;
        let i = $index
      ) {
        <div
          class="py-150 px-300 cursor-pointer rounded border border-gray-500 bg-white transition-colors has-[:checked]:bg-green-200 hover:has-[:checked]:bg-white md:flex-1 [&:is(:hover,:has(:checked,:focus))]:border-green-600"
          [class.!border-red]="hasVisibleErrors(fg.controls.query)"
          (click)="radio.click(); radio.focus()"
        >
          <input
            class="mr-150"
            type="radio"
            id="f-query-type-{{ i }}"
            formControlName="query"
            [value]="i"
            #radio
          />
          <label
            class="pointer-events-none text-base"
            for="f-query-type-{{ i }}"
            >{{ queryType }}</label
          >
        </div>
      }
    </div>
    @if (hasVisibleErrors(fg.controls.query, "required")) {
      <app-validation-message content="Please select a query type" />
    }
  </div>

  <!-- message -->
  <div class="gap-100 flex flex-col">
    <label class="c-star" for="f-message">Message</label>
    <textarea
      class="c-text-field h-[240px] resize-none md:h-[132px] xl:h-[105px]"
      [class.!border-red]="hasVisibleErrors(fg.controls.message)"
      id="f-message"
      formControlName="message"
      autocomplete="off"
    ></textarea>
    @if (hasVisibleErrors(fg.controls.message, "required")) {
      <app-validation-message />
    }
  </div>

  <!-- consent -->
  <div class="my-500">
    <div class="gap-200 flex items-center">
      <div class="relative">
        <input
          class="absolute h-full w-full cursor-pointer appearance-none -outline-offset-2"
          type="checkbox"
          id="f-consent"
          formControlName="consent"
          (change)="onConsentChange($event)"
        />
        <svg width="24" height="24" viewBox="0 0 24 24" fill="none">
          <path
            d="M19.5 3H4.5C4.10218 3 3.72064 3.15804 3.43934 3.43934C3.15804 3.72064 3 4.10218 3 4.5V19.5C3 19.8978 3.15804 20.2794 3.43934 20.5607C3.72064 20.842 4.10218 21 4.5 21H19.5C19.8978 21 20.2794 20.842 20.5607 20.5607C20.842 20.2794 21 19.8978 21 19.5V4.5C21 4.10218 20.842 3.72064 20.5607 3.43934C20.2794 3.15804 19.8978 3 19.5 3ZM19.5 19.5H4.5V4.5H19.5V19.5Z"
            fill="#86A2A5"
          />
          <path
            class="transition-opacity"
            [class]="hasConsented() ? 'opacity-100' : 'opacity-0'"
            d="M19.5 3H4.5C4.10218 3 3.72064 3.15804 3.43934 3.43934C3.15804 3.72064 3 4.10218 3 4.5V19.5C3 19.8978 3.15804 20.2794 3.43934 20.5607C3.72064 20.842 4.10218 21 4.5 21H19.5C19.8978 21 20.2794 20.842 20.5607 20.5607C20.842 20.2794 21 19.8978 21 19.5V4.5C21 4.10218 20.842 3.72064 20.5607 3.43934C20.2794 3.15804 19.8978 3 19.5 3ZM16.2806 10.2806L11.0306 15.5306C10.961 15.6004 10.8783 15.6557 10.7872 15.6934C10.6962 15.7312 10.5986 15.7506 10.5 15.7506C10.4014 15.7506 10.3038 15.7312 10.2128 15.6934C10.1217 15.6557 10.039 15.6004 9.96937 15.5306L7.71937 13.2806C7.57864 13.1399 7.49958 12.949 7.49958 12.75C7.49958 12.551 7.57864 12.3601 7.71937 12.2194C7.86011 12.0786 8.05098 11.9996 8.25 11.9996C8.44902 11.9996 8.63989 12.0786 8.78063 12.2194L10.5 13.9397L15.2194 9.21937C15.2891 9.14969 15.3718 9.09442 15.4628 9.0567C15.5539 9.01899 15.6515 8.99958 15.75 8.99958C15.8485 8.99958 15.9461 9.01899 16.0372 9.0567C16.1282 9.09442 16.2109 9.14969 16.2806 9.21937C16.3503 9.28906 16.4056 9.37178 16.4433 9.46283C16.481 9.55387 16.5004 9.65145 16.5004 9.75C16.5004 9.84855 16.481 9.94613 16.4433 10.0372C16.4056 10.1282 16.3503 10.2109 16.2806 10.2806Z"
            fill="#0C7D69"
          />
        </svg>
      </div>
      <label class="c-star cursor-pointer" for="f-consent"
        >I consent to being contacted by the team</label
      >
    </div>
    @if (hasVisibleErrors(fg.controls.consent, "required")) {
      <app-validation-message
        class="mt-100"
        content="To submit this form, please consent to being contacted"
      />
    }
  </div>

  <button
    class="text-base-bold py-200 hocus-visible:bg-[#063F35] disabled:hover:bg-red rounded bg-green-600 text-white -outline-offset-4 transition-[background-color] disabled:cursor-not-allowed"
    type="submit"
    [disabled]="isSubmissionDisabled()"
  >
    Submit
  </button>
</form>
